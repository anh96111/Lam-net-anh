<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI L√†m N√©t ·∫¢nh - Mi·ªÖn Ph√≠</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé®</text></svg>">
    
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            padding: 15px;
            color: #333;
        }
        
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            animation: slideIn 0.6s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; 
            padding: 40px 30px; 
            text-align: center;
        }
        
        .header h1 { 
            font-size: clamp(2rem, 4vw, 3rem); 
            margin-bottom: 10px; 
            font-weight: 700;
        }
        
        .header p { 
            opacity: 0.9; 
            font-size: 1.1em; 
            margin-bottom: 15px;
        }
        
        .api-selector {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .api-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .api-selector select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            background: white;
            color: #333;
        }
        
        .upload-zone { 
            border: 3px dashed #ddd; 
            margin: 30px; 
            padding: 60px 30px;
            text-align: center; 
            border-radius: 15px;
            transition: all 0.3s ease; 
            cursor: pointer;
            position: relative;
        }
        
        .upload-zone:hover, 
        .upload-zone.dragover { 
            border-color: #667eea; 
            background: linear-gradient(135deg, rgba(102,126,234,0.05) 0%, rgba(118,75,162,0.05) 100%);
            transform: translateY(-2px);
        }
        
        .upload-icon { 
            font-size: 4em; 
            margin-bottom: 20px; 
            opacity: 0.7;
        }
        
        .controls { 
            padding: 30px; 
            display: flex; 
            gap: 15px; 
            flex-wrap: wrap; 
            justify-content: center;
            border-top: 1px solid #eee;
        }
        
        .btn { 
            padding: 15px 25px; 
            border: none; 
            border-radius: 25px;
            cursor: pointer; 
            font-size: 16px; 
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex; 
            align-items: center; 
            gap: 8px;
        }
        
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-success { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; display: none; }
        
        .btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
        }
        
        .btn:disabled { 
            opacity: 0.6; 
            cursor: not-allowed; 
            transform: none; 
            box-shadow: none; 
        }
        
        .progress { 
            display: none; 
            margin: 20px 30px; 
        }
        
        .progress-bar { 
            height: 8px; 
            background: #f0f0f0; 
            border-radius: 10px; 
            overflow: hidden;
        }
        
        .progress-fill { 
            height: 100%; 
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%; 
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #667eea;
        }
        
        .results { 
            display: none; 
            padding: 30px; 
            border-top: 1px solid #eee;
        }
        
        .image-comparison { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 30px; 
            margin-bottom: 30px;
        }
        
        .image-box { 
            background: #f8f9fa; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .image-box h4 { 
            background: linear-gradient(135deg, #333 0%, #555 100%);
            color: white; 
            padding: 15px 20px; 
            margin: 0; 
            font-size: 1.1em;
        }
        
        .image-box img { 
            width: 100%; 
            height: auto; 
            display: block;
        }
        
        .info-box {
            background: #f0f8ff;
            border: 1px solid #4a90e2;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 30px;
            display: none;
        }
        
        .info-box h4 {
            color: #4a90e2;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #555;
            line-height: 1.6;
        }
        
        .footer {
            background: #f8f9fa;
            padding: 25px;
            text-align: center;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .image-comparison { grid-template-columns: 1fr; }
        }
        
        #fileInput { display: none; }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI L√†m N√©t ·∫¢nh</h1>
            <p>S·ª≠ d·ª•ng AI ƒë·ªÉ l√†m n√©t v√† n√¢ng cao ch·∫•t l∆∞·ª£ng ·∫£nh</p>
            
            <div class="api-selector">
                <label for="apiSelect">Ch·ªçn AI Model:</label>
                <select id="apiSelect">
                    <option value="replicate">Replicate AI (Real-ESRGAN) - T·ªët nh·∫•t</option>
                    <option value="deepai">DeepAI Super Resolution</option>
                    <option value="picwish">PicWish API</option>
                    <option value="clipdrop">ClipDrop by Stability AI</option>
                </select>
            </div>
        </div>
        
        <div class="info-box" id="infoBox">
            <h4>‚ÑπÔ∏è H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng AI Model</h4>
            <p id="infoText"></p>
        </div>
        
        <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
            <div class="upload-icon">üì∏</div>
            <h3>K√©o th·∫£ ·∫£nh v√†o ƒë√¢y ho·∫∑c click ƒë·ªÉ ch·ªçn</h3>
            <p>H·ªó tr·ª£: JPG, PNG, WebP (t·ªëi ƒëa 10MB cho AI)</p>
        </div>
        
        <input type="file" id="fileInput" accept="image/*">
        
        <div class="controls">
            <button class="btn btn-primary" id="enhanceBtn" onclick="enhanceWithAI()" disabled>
                <span id="btnText">üöÄ L√†m N√©t v·ªõi AI</span>
                <span class="loading-spinner" style="display: none;"></span>
            </button>
            <button class="btn btn-success" id="downloadBtn" onclick="downloadResult()">
                üíæ T·∫£i Xu·ªëng
            </button>
        </div>
        
        <div class="progress" id="progressContainer">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">ƒêang x·ª≠ l√Ω v·ªõi AI...</div>
        </div>
        
        <div class="results" id="results">
            <h3>üìä So S√°nh K·∫øt Qu·∫£</h3>
            <div class="image-comparison">
                <div class="image-box">
                    <h4>üì∑ ·∫¢nh G·ªëc</h4>
                    <img id="originalImage" alt="Original">
                </div>
                <div class="image-box">
                    <h4>‚ú® ·∫¢nh AI X·ª≠ L√Ω</h4>
                    <img id="resultImage" alt="Enhanced">
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>üí° <strong>S·ª≠ d·ª•ng AI Models mi·ªÖn ph√≠</strong> - Ch·∫•t l∆∞·ª£ng cao nh∆∞ c√°c web chuy√™n nghi·ªáp</p>
        </div>
    </div>

    <script>
        let currentFile = null;
        let resultImageUrl = null;
        
        // API configurations
        const API_CONFIGS = {
            replicate: {
                name: 'Replicate Real-ESRGAN',
                info: 'S·ª≠ d·ª•ng Real-ESRGAN - AI model t·ªët nh·∫•t hi·ªán nay cho upscale v√† l√†m n√©t ·∫£nh. C·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n Replicate mi·ªÖn ph√≠.',
                process: async (file) => {
                    // Replicate API
                    const API_TOKEN = 'r8_YOUR_TOKEN_HERE'; // User c·∫ßn thay token c·ªßa h·ªç
                    
                    if (API_TOKEN.includes('YOUR_TOKEN')) {
                        throw new Error('Vui l√≤ng th√™m Replicate API token. ƒêƒÉng k√Ω mi·ªÖn ph√≠ t·∫°i replicate.com');
                    }
                    
                    const base64 = await fileToBase64(file);
                    
                    const response = await fetch('https://api.replicate.com/v1/predictions', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Token ${API_TOKEN}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            version: 'cjwbw/rembg:fb8af171cfa1616ddcf1242c093f9c46bcada5ad4cf6f2fbe8b81b330ec5c003',
                            input: {
                                image: base64,
                                scale: 4,
                                face_enhance: true
                            }
                        })
                    });
                    
                    const prediction = await response.json();
                    
                    // Poll for result
                    while (prediction.status !== 'succeeded' && prediction.status !== 'failed') {
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        const statusResponse = await fetch(prediction.urls.get, {
                            headers: {
                                'Authorization': `Token ${API_TOKEN}`,
                            }
                        });
                        prediction = await statusResponse.json();
                    }
                    
                    if (prediction.status === 'succeeded') {
                        return prediction.output;
                    } else {
                        throw new Error('AI processing failed');
                    }
                }
            },
            deepai: {
                name: 'DeepAI Super Resolution',
                info: 'DeepAI cung c·∫•p API mi·ªÖn ph√≠ v·ªõi gi·ªõi h·∫°n. Ch·∫•t l∆∞·ª£ng t·ªët cho l√†m n√©t ·∫£nh.',
                process: async (file) => {
                    const formData = new FormData();
                    formData.append('image', file);
                    
                    const response = await fetch('https://api.deepai.org/api/torch-srgan', {
                        method: 'POST',
                        headers: {
                            'api-key': 'quickstart-QUdJIGlzIGNvbWluZy4uLi4K' // Free tier key
                        },
                        body: formData
                    });
                    
                    const result = await response.json();
                    return result.output_url;
                }
            },
            picwish: {
                name: 'PicWish API',
                info: 'PicWish cung c·∫•p c√¥ng ngh·ªá AI ti√™n ti·∫øn. C·∫ßn ƒëƒÉng k√Ω ƒë·ªÉ c√≥ API key mi·ªÖn ph√≠.',
                process: async (file) => {
                    // PicWish implementation
                    const API_KEY = 'YOUR_PICWISH_KEY';
                    
                    if (API_KEY.includes('YOUR')) {
                        throw new Error('C·∫ßn API key t·ª´ PicWish. ƒêƒÉng k√Ω t·∫°i picwish.com/api');
                    }
                    
                    const formData = new FormData();
                    formData.append('image_file', file);
                    
                    const response = await fetch('https://techbigs.com/api/v1/enhance', {
                        method: 'POST',
                        headers: {
                            'X-API-KEY': API_KEY
                        },
                        body: formData
                    });
                    
                    const result = await response.json();
                    return result.data.image;
                }
            },
            clipdrop: {
                name: 'ClipDrop by Stability AI',
                info: 'ClipDrop s·ª≠ d·ª•ng AI c·ªßa Stability AI. Mi·ªÖn ph√≠ v·ªõi watermark, c·∫ßn API key ƒë·ªÉ b·ªè.',
                process: async (file) => {
                    const formData = new FormData();
                    formData.append('image_file', file);
                    formData.append('upscale', '4');
                    
                    const response = await fetch('https://clipdrop-api.co/super-resolution/v1', {
                        method: 'POST',
                        headers: {
                            'x-api-key': 'YOUR_CLIPDROP_KEY' // C·∫ßn thay
                        },
                        body: formData
                    });
                    
                    if (response.ok) {
                        const blob = await response.blob();
                        return URL.createObjectURL(blob);
                    } else {
                        throw new Error('ClipDrop API error');
                    }
                }
            }
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            updateAPIInfo();
        });
        
        function initializeEventListeners() {
            const fileInput = document.getElementById('fileInput');
            const uploadZone = document.getElementById('uploadZone');
            const apiSelect = document.getElementById('apiSelect');
            
            fileInput.addEventListener('change', handleFileSelect);
            apiSelect.addEventListener('change', updateAPIInfo);
            
            // Drag & Drop
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('dragover');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('dragover');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('dragover');
                if (e.dataTransfer.files.length > 0) {
                    handleFile(e.dataTransfer.files[0]);
                }
            });
        }
        
        function updateAPIInfo() {
            const selected = document.getElementById('apiSelect').value;
            const config = API_CONFIGS[selected];
            const infoBox = document.getElementById('infoBox');
            const infoText = document.getElementById('infoText');
            
            infoBox.style.display = 'block';
            infoText.textContent = config.info;
        }
        
        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        }
        
        function handleFile(file) {
            if (!file || !file.type.startsWith('image/')) {
                alert('Vui l√≤ng ch·ªçn file ·∫£nh h·ª£p l·ªá!');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                alert('File qu√° l·ªõn! Vui l√≤ng ch·ªçn ·∫£nh d∆∞·ªõi 10MB cho AI x·ª≠ l√Ω.');
                return;
            }
            
            currentFile = file;
            
            // Display original image
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('originalImage').src = e.target.result;
                document.getElementById('results').style.display = 'block';
                document.getElementById('enhanceBtn').disabled = false;
            };
            reader.readAsDataURL(file);
        }
        
        async function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
        
        async function enhanceWithAI() {
            if (!currentFile) {
                alert('Vui l√≤ng ch·ªçn ·∫£nh tr∆∞·ªõc!');
                return;
            }
            
            const selected = document.getElementById('apiSelect').value;
            const config = API_CONFIGS[selected];
            const btn = document.getElementById('enhanceBtn');
            const btnText = document.getElementById('btnText');
            const spinner = btn.querySelector('.loading-spinner');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            // Show loading
            btn.disabled = true;
            btnText.style.display = 'none';
            spinner.style.display = 'inline-block';
            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';
            
            // Animate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 90) progress = 90;
                progressBar.style.width = progress + '%';
                progressText.textContent = `ƒêang x·ª≠ l√Ω v·ªõi ${config.name}... ${Math.round(progress)}%`;
            }, 500);
            
            try {
                // Process with selected API
                resultImageUrl = await config.process(currentFile);
                
                // Display result
                document.getElementById('resultImage').src = resultImageUrl;
                document.getElementById('downloadBtn').style.display = 'inline-flex';
                
                // Complete progress
                clearInterval(progressInterval);
                progressBar.style.width = '100%';
                progressText.textContent = 'Ho√†n th√†nh!';
                
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                }, 1500);
                
            } catch (error) {
                clearInterval(progressInterval);
                alert(`L·ªói: ${error.message}\n\nG·ª£i √Ω: ${config.info}`);
                progressContainer.style.display = 'none';
            } finally {
                // Reset button
                btn.disabled = false;
                btnText.style.display = 'inline';
                spinner.style.display = 'none';
            }
        }
        
        function downloadResult() {
            if (!resultImageUrl) {
                alert('Kh√¥ng c√≥ ·∫£nh ƒë·ªÉ t·∫£i xu·ªëng!');
                return;
            }
            
            const link = document.createElement('a');
            link.download = `ai_enhanced_${Date.now()}.png`;
            link.href = resultImageUrl;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
